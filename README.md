# 钢琴打卡统计程序

这是一个用于统计钢琴练习打卡记录的程序。它可以生成每周的打卡统计表、排名表，以及未达标成员的提醒消息。

## 使用前准备

### 1. 必需文件

程序运行需要两个必需的输入文件，文件名格式为：`YYYYMMDD-YYYYMMDD_文件类型.md`
例如：对于2025年3月17日开始的一周，文件名应该是：

1. `20250317-20250323_在群人员名单.md`
   - 包含本周所有群成员的基本信息
   - 文件格式要求：
   ```
   ## 在群人员名单
   群号    昵称    城市    群状态
   1    安    重庆    留群志愿者
   3    Savannah    英国伦敦    
   4    糯米糍    四川成都    
   ...
   ```
   - 群状态为空表示需要打卡的成员
   - 群状态填写"请假出群"或其他状态的成员不参与统计

2. `20250317-20250323_打卡记录.md`
   - 包含本周所有的打卡记录
   - 文件格式要求：
   ```
   # 接龙
   2025年3月17日 星期一
   
   例 当天练习总时长分钟数。练习内容。备注
   
   1. 。140。VV（四川成都）。70。拜厄89.90.94，乐曲。交作业啦
   2. 。150。三变（浙江杭州）。90。拜厄60，菲伯尔2首曲子开谱
   ...
   ```
   - 每天的记录需要包含日期标题
   - 每条记录格式：序号。。成员ID。昵称（城市）。分钟数。内容

### 2. 文件放置

1. 将这两个文件放在与程序相同的目录下
2. 确保文件名中的日期正确（开始日期和结束日期）
3. 确保文件使用 UTF-8 编码保存

## 运行程序

1. 给脚本添加执行权限：
   ```bash
   chmod +x run.sh
   ```

2. 运行脚本，传入开始日期参数：
   ```bash
   ./run.sh YYYYMMDD
   ```
   例如：
   ```bash
   ./run.sh 20250317
   ```

3. 程序会自动：
   - 验证日期格式
   - 检查必需文件是否存在
   - 计算结束日期（开始日期+6天）
   - 生成以下输出文件：
     - `YYYYMM月打卡（M.D-M.D）.xlsx`：详细的打卡记录表
     - `YYYYMM月打卡排名（M.D-M.D）.xlsx`：本周排名表
     - `oncall_msg.txt`：未达标成员提醒消息

## 统计规则

1. 达标标准（满足任一即可）：
   - 总时长 ≥ 120分钟（2小时）
   - 打卡天数 ≥ 2天

2. 统计范围：
   - 只统计群状态为空的成员
   - 请假出群等状态的成员不参与统计

## 注意事项

1. 文件名必须严格按照格式命名，包括日期和下划线
2. 在群人员名单中的群状态对统计结果有重要影响
3. 打卡记录的格式必须规范，包括日期标题和打卡内容
4. 如果跨月，程序会自动处理月份变更

## 常见问题

1. 如果程序报错找不到文件，请检查：
   - 文件名是否正确
   - 文件是否在正确的目录
   - 开始日期是否正确

2. 如果统计结果异常，请检查：
   - 在群人员名单的格式是否正确
   - 打卡记录的格式是否规范
   - 是否有重复的打卡记录

3. 如果运行脚本时提示"Permission denied"：
   - 确保已经给脚本添加执行权限：`chmod +x run.sh`
